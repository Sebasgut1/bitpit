---
layout: doxygen_header
title: Manual - PABLO_example_00011.cpp
section: documentation
doxygen-show-titlearea: 0
extra-head-includes:
    - doxygen_extra_head.html
---
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
{% if page.doxygen-show-titlearea == 1 %}
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">bitpit
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
{% endif %}
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">PABLO_example_00011.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>3D adaptive mesh refinement (AMR) using PABLOThis example creates a 3D Octree mesh on the cube domain [0,1]x[0,1]x[0,1].</p>
<p>The domain is refined globally one time and periodic conditions are imposed on the boundaries of the domain. Then, the face, vertex and edge neighbors of the cells are found and print.</p>
<p><b>To run</b>: ./PABLO_example_00011 <br  />
 Thanks to <a href="https://www.surrey.ac.uk/people/maxime-delorme">Maxime Delorme</a> for this example.</p>
<div class="fragment"><div class="line"><span class="comment">/*---------------------------------------------------------------------------*\</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  bitpit</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  Copyright (C) 2015-2021 OPTIMAD engineering Srl</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  -------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"> *  License</span></div>
<div class="line"><span class="comment"> *  This file is part of bitpit.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  bitpit is free software: you can redistribute it and/or modify it</span></div>
<div class="line"><span class="comment"> *  under the terms of the GNU Lesser General Public License v3 (LGPL)</span></div>
<div class="line"><span class="comment"> *  as published by the Free Software Foundation.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  bitpit is distributed in the hope that it will be useful, but WITHOUT</span></div>
<div class="line"><span class="comment"> *  ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span></div>
<div class="line"><span class="comment"> *  FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public</span></div>
<div class="line"><span class="comment"> *  License for more details.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span></div>
<div class="line"><span class="comment"> *  along with bitpit. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment">\*---------------------------------------------------------------------------*/</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#if BITPIT_ENABLE_MPI==1</span></div>
<div class="line"><span class="preprocessor">#include &lt;mpi.h&gt;</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;bitpit_PABLO.hpp&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span>bitpit;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// =================================================================================== //</span></div>
<div class="line"><span class="comment"></span><span class="comment">// =================================================================================== //</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> run()</div>
<div class="line">{</div>
<div class="line">    PabloUniform pablo11(3);</div>
<div class="line"> </div>
<div class="line">    pablo11.setPeriodic(0);</div>
<div class="line">    pablo11.setPeriodic(2);</div>
<div class="line">    pablo11.setPeriodic(4);</div>
<div class="line"> </div>
<div class="line">    pablo11.computeConnectivity();</div>
<div class="line">    pablo11.write(<span class="stringliteral">&quot;pablo000011.0&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    pablo11.adaptGlobalRefine();</div>
<div class="line">    pablo11.updateConnectivity();</div>
<div class="line">    pablo11.write(<span class="stringliteral">&quot;pablo000011.1&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    uint32_t nOct = pablo11.getNumOctants();</div>
<div class="line">    <a name="a0"></a><a class="code" href="namespacebitpit_1_1log.html#ac9c385c32dc5a0331c601b1b07ab9952">log::cout</a>() &lt;&lt; <span class="stringliteral">&quot;Number of Octants : &quot;</span> &lt;&lt; nOct &lt;&lt; std::endl;</div>
<div class="line">    <a class="code" href="namespacebitpit_1_1log.html#ac9c385c32dc5a0331c601b1b07ab9952">log::cout</a>() &lt;&lt; <span class="stringliteral">&quot;Extracting the four face neighbours of each Octant &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">for</span> (uint32_t iOct = 0; iOct &lt; nOct; ++iOct) {</div>
<div class="line">        std::vector&lt;uint32_t&gt; neigh;</div>
<div class="line">        std::vector&lt;bool&gt; isGhost;</div>
<div class="line">        <a class="code" href="namespacebitpit_1_1log.html#ac9c385c32dc5a0331c601b1b07ab9952">log::cout</a>() &lt;&lt; <span class="stringliteral">&quot;. Octant index : &quot;</span> &lt;&lt; iOct &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">for</span> (uint8_t iFace=0; iFace&lt;pablo11.getNfaces(); ++iFace) {</div>
<div class="line">            pablo11.findNeighbours(iOct, iFace, 1, neigh, isGhost);</div>
<div class="line">            <a class="code" href="namespacebitpit_1_1log.html#ac9c385c32dc5a0331c601b1b07ab9952">log::cout</a>() &lt;&lt; <span class="stringliteral">&quot; - For face &quot;</span> &lt;&lt; (int)iFace &lt;&lt; <span class="stringliteral">&quot;; &quot;</span> &lt;&lt; neigh.size() &lt;&lt; <span class="stringliteral">&quot; neighbours: [ &quot;</span>;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keyword">auto</span> iNeigh : neigh) {</div>
<div class="line">                <a class="code" href="namespacebitpit_1_1log.html#ac9c385c32dc5a0331c601b1b07ab9952">log::cout</a>() &lt;&lt; iNeigh &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line">            }</div>
<div class="line">            <a class="code" href="namespacebitpit_1_1log.html#ac9c385c32dc5a0331c601b1b07ab9952">log::cout</a>() &lt;&lt; <span class="stringliteral">&quot;]&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespacebitpit_1_1log.html#ac9c385c32dc5a0331c601b1b07ab9952">log::cout</a>() &lt;&lt; <span class="stringliteral">&quot;Extracting the four vertex neighbours of each Octant &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">for</span> (uint32_t iOct = 0; iOct &lt; nOct; ++iOct) {</div>
<div class="line">        std::vector&lt;uint32_t&gt; neigh;</div>
<div class="line">        std::vector&lt;bool&gt; isGhost;</div>
<div class="line">        <a class="code" href="namespacebitpit_1_1log.html#ac9c385c32dc5a0331c601b1b07ab9952">log::cout</a>() &lt;&lt; <span class="stringliteral">&quot;. Octant index : &quot;</span> &lt;&lt; iOct &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">for</span> (uint8_t iVertex=0; iVertex&lt;pablo11.getNnodes(); ++iVertex) {</div>
<div class="line">            pablo11.findNeighbours(iOct, iVertex, 3, neigh, isGhost);</div>
<div class="line">            <a class="code" href="namespacebitpit_1_1log.html#ac9c385c32dc5a0331c601b1b07ab9952">log::cout</a>() &lt;&lt; <span class="stringliteral">&quot; - For vertex &quot;</span> &lt;&lt; (int)iVertex &lt;&lt; <span class="stringliteral">&quot;; &quot;</span> &lt;&lt; neigh.size() &lt;&lt; <span class="stringliteral">&quot; neighbours: [ &quot;</span>;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keyword">auto</span> iNeigh: neigh) {</div>
<div class="line">                <a class="code" href="namespacebitpit_1_1log.html#ac9c385c32dc5a0331c601b1b07ab9952">log::cout</a>() &lt;&lt; iNeigh &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line">            }</div>
<div class="line">            <a class="code" href="namespacebitpit_1_1log.html#ac9c385c32dc5a0331c601b1b07ab9952">log::cout</a>() &lt;&lt; <span class="stringliteral">&quot;]&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespacebitpit_1_1log.html#ac9c385c32dc5a0331c601b1b07ab9952">log::cout</a>() &lt;&lt; <span class="stringliteral">&quot;Extracting the four edge neighbours of each Octant &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">for</span> (uint32_t iOct=0; iOct &lt; nOct; ++iOct) {</div>
<div class="line">        std::vector&lt;uint32_t&gt; neigh;</div>
<div class="line">        std::vector&lt;bool&gt; isGhost;</div>
<div class="line">        <a class="code" href="namespacebitpit_1_1log.html#ac9c385c32dc5a0331c601b1b07ab9952">log::cout</a>() &lt;&lt; <span class="stringliteral">&quot;. Octant index : &quot;</span> &lt;&lt; iOct &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">for</span> (uint8_t iEdge = 0; iEdge&lt;pablo11.getNedges(); ++iEdge) {</div>
<div class="line">            pablo11.findNeighbours(iOct, iEdge, 2, neigh, isGhost);</div>
<div class="line">            <a class="code" href="namespacebitpit_1_1log.html#ac9c385c32dc5a0331c601b1b07ab9952">log::cout</a>() &lt;&lt; <span class="stringliteral">&quot; - For edge &quot;</span> &lt;&lt; (int)iEdge &lt;&lt; <span class="stringliteral">&quot;; &quot;</span> &lt;&lt; neigh.size() &lt;&lt; <span class="stringliteral">&quot; neighbours: [ &quot;</span>;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keyword">auto</span> iNeigh: neigh) {</div>
<div class="line">                <a class="code" href="namespacebitpit_1_1log.html#ac9c385c32dc5a0331c601b1b07ab9952">log::cout</a>() &lt;&lt; iNeigh &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line">            }</div>
<div class="line">            <a class="code" href="namespacebitpit_1_1log.html#ac9c385c32dc5a0331c601b1b07ab9952">log::cout</a>() &lt;&lt; <span class="stringliteral">&quot;]&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line"><span class="preprocessor">#if BITPIT_ENABLE_MPI==1</span></div>
<div class="line">    MPI_Init(&amp;argc,&amp;argv);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    <a name="a1"></a><a class="code" href="group__common__macro.html#gacb5eef7cdb2adda3b65bfe01c66667a4">BITPIT_UNUSED</a>(argc);</div>
<div class="line">    <a class="code" href="group__common__macro.html#gacb5eef7cdb2adda3b65bfe01c66667a4">BITPIT_UNUSED</a>(argv);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> nProcs;</div>
<div class="line">    <span class="keywordtype">int</span> rank;</div>
<div class="line"><span class="preprocessor">#if BITPIT_ENABLE_MPI==1</span></div>
<div class="line">    MPI_Comm_size(MPI_COMM_WORLD, &amp;nProcs);</div>
<div class="line">    MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    nProcs = 1;</div>
<div class="line">    rank   = 0;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Initialize the logger</span></div>
<div class="line">    <a name="a2"></a><a class="code" href="namespacebitpit_1_1log.html#ad3e7fef0bec2cde00a65b3eaf0a319d0">log::manager</a>().<a name="a3"></a><a class="code" href="classbitpit_1_1LoggerManager.html#a07340544e6aae3d5174c9c2d39888d79">initialize</a>(log::SEPARATE, <span class="keyword">false</span>, nProcs, rank);</div>
<div class="line">    <a class="code" href="namespacebitpit_1_1log.html#ac9c385c32dc5a0331c601b1b07ab9952">log::cout</a>() &lt;&lt; <a class="code" href="namespacebitpit_1_1log.html#acd50005e81bd303fa96065d563592348">fileVerbosity</a>(<a name="a4"></a><a class="code" href="namespacebitpit_1_1log.html#a19918daf77e8598ba40ef3a290549efaa4c09f2c05d88c37ce54a5bc74d6a4071">log::NORMAL</a>);</div>
<div class="line">    <a class="code" href="namespacebitpit_1_1log.html#ac9c385c32dc5a0331c601b1b07ab9952">log::cout</a>() &lt;&lt; <a class="code" href="namespacebitpit_1_1log.html#ad6f89bcb2adf0f51cb232969b714e83b">consoleVerbosity</a>(<a name="a5"></a><a class="code" href="namespacebitpit_1_1log.html#a19918daf77e8598ba40ef3a290549efaa53c0f5e20dcbeb9a1af06f16a3cba943">log::QUIET</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Run the example</span></div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line">        run();</div>
<div class="line">    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;exception) {</div>
<div class="line">        <a class="code" href="namespacebitpit_1_1log.html#ac9c385c32dc5a0331c601b1b07ab9952">log::cout</a>() &lt;&lt; exception.what();</div>
<div class="line">        exit(1);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#if BITPIT_ENABLE_MPI==1</span></div>
<div class="line">    MPI_Finalize();</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">}</div>
<div class="ttc" id="aclassbitpit_1_1LoggerManager_html_a07340544e6aae3d5174c9c2d39888d79"><div class="ttname"><a href="classbitpit_1_1LoggerManager.html#a07340544e6aae3d5174c9c2d39888d79">bitpit::LoggerManager::initialize</a></div><div class="ttdeci">void initialize(log::Mode mode, bool reset, int nProcessors, int rank)</div><div class="ttdef"><b>Definition:</b> <a href="logger_8cpp_source.html#l00990">logger.cpp:990</a></div></div>
<div class="ttc" id="agroup__common__macro_html_gacb5eef7cdb2adda3b65bfe01c66667a4"><div class="ttname"><a href="group__common__macro.html#gacb5eef7cdb2adda3b65bfe01c66667a4">BITPIT_UNUSED</a></div><div class="ttdeci">#define BITPIT_UNUSED(variable)</div><div class="ttdef"><b>Definition:</b> <a href="compiler_8hpp_source.html#l00063">compiler.hpp:63</a></div></div>
<div class="ttc" id="anamespacebitpit_1_1log_html_a19918daf77e8598ba40ef3a290549efaa4c09f2c05d88c37ce54a5bc74d6a4071"><div class="ttname"><a href="namespacebitpit_1_1log.html#a19918daf77e8598ba40ef3a290549efaa4c09f2c05d88c37ce54a5bc74d6a4071">bitpit::log::NORMAL</a></div><div class="ttdeci">@ NORMAL</div><div class="ttdef"><b>Definition:</b> <a href="logger_8hpp_source.html#l00054">logger.hpp:54</a></div></div>
<div class="ttc" id="anamespacebitpit_1_1log_html_a19918daf77e8598ba40ef3a290549efaa53c0f5e20dcbeb9a1af06f16a3cba943"><div class="ttname"><a href="namespacebitpit_1_1log.html#a19918daf77e8598ba40ef3a290549efaa53c0f5e20dcbeb9a1af06f16a3cba943">bitpit::log::QUIET</a></div><div class="ttdeci">@ QUIET</div><div class="ttdef"><b>Definition:</b> <a href="logger_8hpp_source.html#l00053">logger.hpp:53</a></div></div>
<div class="ttc" id="anamespacebitpit_1_1log_html_ac9c385c32dc5a0331c601b1b07ab9952"><div class="ttname"><a href="namespacebitpit_1_1log.html#ac9c385c32dc5a0331c601b1b07ab9952">bitpit::log::cout</a></div><div class="ttdeci">Logger &amp; cout()</div><div class="ttdef"><b>Definition:</b> <a href="logger_8cpp_source.html#l01366">logger.cpp:1366</a></div></div>
<div class="ttc" id="anamespacebitpit_1_1log_html_acd50005e81bd303fa96065d563592348"><div class="ttname"><a href="namespacebitpit_1_1log.html#acd50005e81bd303fa96065d563592348">bitpit::log::fileVerbosity</a></div><div class="ttdeci">LoggerManipulator&lt; log::Verbosity &gt; fileVerbosity(const log::Verbosity &amp;verbosity)</div><div class="ttdef"><b>Definition:</b> <a href="logger_8cpp_source.html#l01546">logger.cpp:1546</a></div></div>
<div class="ttc" id="anamespacebitpit_1_1log_html_ad3e7fef0bec2cde00a65b3eaf0a319d0"><div class="ttname"><a href="namespacebitpit_1_1log.html#ad3e7fef0bec2cde00a65b3eaf0a319d0">bitpit::log::manager</a></div><div class="ttdeci">LoggerManager &amp; manager()</div><div class="ttdef"><b>Definition:</b> <a href="logger_8cpp_source.html#l01356">logger.cpp:1356</a></div></div>
<div class="ttc" id="anamespacebitpit_1_1log_html_ad6f89bcb2adf0f51cb232969b714e83b"><div class="ttname"><a href="namespacebitpit_1_1log.html#ad6f89bcb2adf0f51cb232969b714e83b">bitpit::log::consoleVerbosity</a></div><div class="ttdeci">LoggerManipulator&lt; log::Verbosity &gt; consoleVerbosity(const log::Verbosity &amp;verbosity)</div><div class="ttdef"><b>Definition:</b> <a href="logger_8cpp_source.html#l01517">logger.cpp:1517</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
---
layout: doxygen_footer
---
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<address class="footer"><small>
Generated on Mon Mar 29 2021 21:17:46 for bitpit by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.9.1
</small></address>
